(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{266:function(e,v,t){"use strict";t.r(v);var _=t(4),s=Object(_.a)({},function(){var e=this,v=e.$createElement,t=e._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"переменные-окружения-и-режимы-работы"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#переменные-окружения-и-режимы-работы","aria-hidden":"true"}},[e._v("#")]),e._v(" Переменные окружения и режимы работы")]),e._v(" "),t("p",[e._v("Вы можете указать переменные окружения в специальных файлах в корне вашего проекта:")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v(".env                "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# загружается во всех случаях")]),e._v("\n.env.local          "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# загружается во всех случаях, игнорируется git")]),e._v("\n.env."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("mode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("         "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# загружается только в указанном режиме работы")]),e._v("\n.env."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("mode"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v(".local   "),t("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# загружается только в указанном режиме работы, игнорируется git")]),e._v("\n")])])]),t("p",[e._v("Такой "),t("code",[e._v(".env")]),e._v(" файл просто содержит пары ключ=значение требуемых переменных окружения:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("FOO=bar\nVUE_APP_SECRET=secret\n")])])]),t("p",[e._v("Эти переменные будут доступны для всех команд "),t("code",[e._v("vue-cli-service")]),e._v(", плагинов и зависимостей.")]),e._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("Приоритет загрузки переменных окружения")]),e._v(" "),t("p",[e._v("Файл с переменными для определённого режима работы (например, "),t("code",[e._v(".env.production")]),e._v(") имеет более высокий приоритет, чем общий файл (например, "),t("code",[e._v(".env")]),e._v(").")]),e._v(" "),t("p",[e._v("Кроме того, переменные окружения, которые уже существуют при загрузке Vue CLI имеют наивысший приоритет и не будут перезаписаны значениями из файлов "),t("code",[e._v(".env")]),e._v(".")])]),e._v(" "),t("div",{staticClass:"warning custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("Предупреждение об использовании NODE_ENV")]),e._v(" "),t("p",[e._v("Если в вашем окружении по умолчанию установлен "),t("code",[e._v("NODE_ENV")]),e._v(", вы должны либо удалить его, либо явно установить "),t("code",[e._v("NODE_ENV")]),e._v(" при выполнении команд "),t("code",[e._v("vue-cli-service")]),e._v(".")])]),e._v(" "),t("h2",{attrs:{id:"режимы-работы"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#режимы-работы","aria-hidden":"true"}},[e._v("#")]),e._v(" Режимы работы")]),e._v(" "),t("p",[t("strong",[e._v("Режимы работы")]),e._v(" — важная часть проектов Vue CLI. По умолчанию, есть три режима работы:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("development")]),e._v(" используется "),t("code",[e._v("vue-cli-service serve")])]),e._v(" "),t("li",[t("code",[e._v("production")]),e._v(" используется "),t("code",[e._v("vue-cli-service build")]),e._v(" и "),t("code",[e._v("vue-cli-service test:e2e")])]),e._v(" "),t("li",[t("code",[e._v("test")]),e._v(" используется "),t("code",[e._v("vue-cli-service test:unit")])])]),e._v(" "),t("p",[e._v("Обратите внимание, что режим работы отличается от "),t("code",[e._v("NODE_ENV")]),e._v(", поскольку режим может устанавливать несколько переменных окружения. Тем не менее, каждый режим устанавливает "),t("code",[e._v("NODE_ENV")]),e._v(" в такое же значение по умолчанию — например, "),t("code",[e._v("NODE_ENV")]),e._v(" будет установлен в "),t("code",[e._v('"development"')]),e._v(" в режиме разработки.")]),e._v(" "),t("p",[e._v("Вы можете установить переменные окружения только для определённого режима работы с помощью постфикса "),t("code",[e._v(".env")]),e._v(" файла. Например, если создать файл с именем "),t("code",[e._v(".env.development")]),e._v(" в корне вашего проекта, тогда переменные объявленные в нём будут загружаться только в режиме development.")]),e._v(" "),t("p",[e._v("Вы можете переопределить режим по умолчанию для команды, с помощью опции "),t("code",[e._v("--mode")]),e._v(". Например, если необходимо использовать переменные для разработки в команде сборки, добавьте это в свои скрипты "),t("code",[e._v("package.json")]),e._v(":")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('"dev-build": "vue-cli-service build --mode development",\n')])])]),t("h2",{attrs:{id:"пример-режим-staging"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#пример-режим-staging","aria-hidden":"true"}},[e._v("#")]),e._v(" Пример: режим Staging")]),e._v(" "),t("p",[e._v("Предположим, что у нас есть приложение с "),t("code",[e._v(".env")]),e._v(" файлом:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("VUE_APP_TITLE=My App\n")])])]),t("p",[e._v("И следующий "),t("code",[e._v(".env.staging")]),e._v(" файл:")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("NODE_ENV=production\nVUE_APP_TITLE=My App (staging)\n")])])]),t("ul",[t("li",[t("p",[t("code",[e._v("vue-cli-service build")]),e._v(" собирает приложение для production, загружает "),t("code",[e._v(".env")]),e._v(", "),t("code",[e._v(".env.production")]),e._v(" и "),t("code",[e._v(".env.production.local")]),e._v(" если они присутствуют;")])]),e._v(" "),t("li",[t("p",[t("code",[e._v("vue-cli-service build --mode staging")]),e._v(" собирает приложение для production в режиме staging, используя "),t("code",[e._v(".env")]),e._v(", "),t("code",[e._v(".env.staging")]),e._v(" и "),t("code",[e._v(".env.staging.local")]),e._v(" если они присутствуют.")])])]),e._v(" "),t("p",[e._v("В обоих случаях приложение собирается для production из-за установленного "),t("code",[e._v("NODE_ENV")]),e._v(", но в режиме staging, "),t("code",[e._v("process.env.VUE_APP_TITLE")]),e._v(" будет перезаписываться другим значением.")]),e._v(" "),t("h2",{attrs:{id:"испоnьзование-переменных-окружения-в-кnиентском-коде"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#испоnьзование-переменных-окружения-в-кnиентском-коде","aria-hidden":"true"}},[e._v("#")]),e._v(" Использование переменных окружения в клиентском коде")]),e._v(" "),t("p",[e._v("Только переменные с префиксом "),t("code",[e._v("VUE_APP_")]),e._v(" статически внедряются в клиентскую сборку используя "),t("code",[e._v("webpack.DefinePlugin")]),e._v(". К ним можно получить доступ из кода вашего приложения:")]),e._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[e._v("console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[e._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),e._v("process"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("env"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),t("span",{pre:!0,attrs:{class:"token constant"}},[e._v("VUE_APP_SECRET")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n")])])]),t("p",[e._v("На этапе сборки "),t("code",[e._v("process.env.VUE_APP_SECRET")]),e._v(" будет заменяться соответствующим значением. Когда в файле указано "),t("code",[e._v("VUE_APP_SECRET=secret")]),e._v(" — после сборки значением будет "),t("code",[e._v('"secret"')]),e._v(".")]),e._v(" "),t("p",[e._v("В дополнение к переменным "),t("code",[e._v("VUE_APP_*")]),e._v(" также есть две специальные переменные, которые всегда доступны в коде вашего приложения:")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("NODE_ENV")]),e._v(" — значение будет "),t("code",[e._v('"development"')]),e._v(", "),t("code",[e._v('"production"')]),e._v(" или "),t("code",[e._v('"test"')]),e._v(" в зависимости от "),t("a",{attrs:{href:"#%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D1%8B-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%8B"}},[e._v("режима работы")]),e._v(" в котором работает приложение.")]),e._v(" "),t("li",[t("code",[e._v("BASE_URL")]),e._v(" — соответствует опции "),t("code",[e._v("publicPath")]),e._v(" в "),t("code",[e._v("svelte.config.js")]),e._v(" и определяет базовый путь по которому опубликовано ваше приложение.")])]),e._v(" "),t("p",[e._v("Все разрешённые переменные окружения также будут доступны внутри "),t("code",[e._v("public/index.html")]),e._v(" как обсуждалось ранее в разделе "),t("router-link",{attrs:{to:"/ru/guide/html-and-static-assets.html#интерпоnяции"}},[e._v("HTML - Интерполяции")]),e._v(".")],1),e._v(" "),t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[e._v("Совет")]),e._v(" "),t("p",[e._v("Можно добавлять вычисляемые переменные окружения в "),t("code",[e._v("svelte.config.js")]),e._v(". Они по-прежнему должны именоваться с префикса "),t("code",[e._v("VUE_APP_")]),e._v(". Это может пригодиться например для получения информации о версии "),t("code",[e._v("process.env.VUE_APP_VERSION = require('./package.json').version")])])]),e._v(" "),t("h2",{attrs:{id:"переменные-тоnько-дnя-nокаnьного-окружения"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#переменные-тоnько-дnя-nокаnьного-окружения","aria-hidden":"true"}},[e._v("#")]),e._v(" Переменные только для локального окружения")]),e._v(" "),t("p",[e._v("Иногда необходимы переменные окружения, которые не должны быть привязаны к кодовой базе, особенно если ваш проект размещается в публичном репозитории. В таком случае вы должны использовать файл "),t("code",[e._v(".env.local")]),e._v(". Локальные env-файлы добавлены в "),t("code",[e._v(".gitignore")]),e._v(" по умолчанию.")]),e._v(" "),t("p",[t("code",[e._v(".local")]),e._v(" также могут добавляться к env-файлам специфичным для режима работы, например "),t("code",[e._v(".env.development.local")]),e._v(" будет загружен во время разработки, и будет игнорироваться git.")])])},[],!1,null,null,null);v.default=s.exports}}]);